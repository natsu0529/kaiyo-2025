## 📄 CURRICULUM_RULE_EXPLANATION.md: 履修ルールデータ解説

このドキュメントは、アプリのコア機能である進級・卒業判定ロジックに使用される静的データファイル（`CURRICULUM_*.json`）の構造と、各フィールドの意味、およびロジックの実装方針を解説します。

---

## 1. 📂 ファイル構成と適用範囲

学科ごとにファイルを分割しています。アプリは、ユーザーが選択した**学科**と**入学年度**に基づき、適切なファイルとルールセットを選択する必要があります。

| ファイル名                  | 対象学科           | コース情報                                      |
| :-------------------------- | :----------------- | :---------------------------------------------- |
| `CURRICULUM_CAP_RULES.json` | 海事システム工学科 | なし                                            |
| `CURRICULUM_ENG_RULES.json` | 海洋電子機械工学科 | 機関システム工学コース / 制御システム工学コース |
| `CURRICULUM_LOG_RULES.json` | 流通情報工学科     | なし                                            |

---

## 2. 🧱 JSON データ構造とフィールド解説

各ルールセットは、`enrollmentYearRange`と`department`で識別され、以下の主要なオブジェクトを含みます。

| フィールド名             | 型           | 説明                                                                                              |
| :----------------------- | :----------- | :------------------------------------------------------------------------------------------------ |
| `enrollmentYearRange`    | `Array<Int>` | ルールが適用される**入学年度の範囲** (`[開始年度, 終了年度]`)。`9999`は最新年度以降を意味します。 |
| `course`                 | `String`     | コース名。海洋電子機械工学科でのみ使用されます。                                                  |
| `graduationTotalCredits` | `Int`        | 卒業に必要な**総単位数**。                                                                        |
| `requiredLimits`         | `Object`     | 各科目区分の**卒業要件単位数（進級基準算入の**上限**）**を定義。オーバー単位判定のコアデータ。    |
| `progressionRules`       | `Object`     | 2 年、3 年、4 年進級の具体的な基準を定義します。                                                  |

---

## 3. ⚖️ `requiredLimits` (進級基準算入上限) の実装方針

このオブジェクトの値は、ユーザーの修得単位が**卒業要件の範囲内**に収まっているか（オーバー単位の判定）をチェックするために使用されます。

### 3.1. 総合科目のオーバー単位処理（自由選択の生成）

- **ルール:** 総合科目の各区分（例: 文化学系、外国語系）で修得単位数が`requiredLimits`を超過した場合、その超過単位は自動的に**「総合科目\_自由選択」**の単位として算入されます。
- **実装:** アプリは、`requiredLimits`の各項目（`総合科目_*`）をチェックし、超過分を`総合科目_自由選択`の修得単位に加算することで、卒業要件としての**自由選択単位**（通常 4 単位）を満たしているか判定する必要があります。

### 3.2. 専門科目・選択の複雑な算入ロジック（重要）

| JSON キー                                               | 対象学科               | ロジックの注意点                                                                                                                                                    |
| :------------------------------------------------------ | :--------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `専門科目_選択_船舶管理系` / `専門科目_選択_海事工学系` | **海事システム工学科** | ユーザーが修得した**両系統の単位数のうち、多い方の単位数**のみを算入上限（22 単位または 18 単位）として使用すること。少ない方の系統の単位はオーバー単位となります。 |
| `専門科目_選択_他コース他学科等上限`                    | **全学科**             | 選択科目総単位数（`専門科目_選択科目_合計`）の**内数**として、他コース・他学科からの算入が認められる上限単位数（通常 6 単位）を示します。                           |

---

## 4. 🚀 `progressionRules` (進級判定基準) の実装方針

このオブジェクトに基づいて、「残り習得すべき単位」タブの進級・卒業条件を判定します。

### 4.1. 単位数基準 (`totalRequiredCredits`)

- **判定:** アプリは、上記 3.のロジックに基づいて計算された**「進級基準に算入される単位数」**が、`totalRequiredCredits`に達しているかチェックします。

### 4.2. 指定科目の修得 (`requiredCourses`)

- **判定:**
  - **3 年次進級時:** リスト内の**6 科目全て**（Basic English I/II, Practical English I, 微分積分 Ⅰ, 線形代数 Ⅰ, 物理学）を修得しているか確認し、未修得科目があれば**単位数不足とは別に警告**を表示します。
  - **4 年次進級時 (2021 年度以降):** `GLI演習Ⅰ`の修得が必須となります。
